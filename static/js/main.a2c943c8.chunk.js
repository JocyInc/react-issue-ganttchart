(this["webpackJsonpreact-issue-ganttchart"]=this["webpackJsonpreact-issue-ganttchart"]||[]).push([[0],{23:function(t,e,n){t.exports=n(53)},28:function(t,e,n){},50:function(t,e,n){},51:function(t,e,n){},52:function(t,e,n){},53:function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),r=n(21),i=n.n(r),s=(n(28),n(3)),c=n(4),u=n(6),l=n(5),d=n(7),h=n(11),g=n.n(h),m=n(22),p=n(1),f=n(8),k=n.n(f),v=(n(48),n(9)),b=n.n(v),y=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(u.a)(this,Object(l.a)(e).call(this,t))).dataProcessor=null,n.getGitHubIssues=Object(m.a)(g.a.mark((function t(){var e;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e="https://api.github.com/repos/lamact/react-issue-ganttchart/issues",k.a.get(e).then((function(t){t.data.map((function(t){return k.a.get(e+"/"+t.number).then((function(e){var a,o,r=n.getStartDateFromBodyString(e.data.body),i=n.getDueDateFromBodyString(e.data.body),s=null;if(null!=r&&null!=i){var c=b()(r),u=b()(i);a=r.toLocaleDateString("ja-JP"),o=u.diff(c,"days"),s=!1}else a=new Date(t.created_at).toLocaleDateString("ja-JP"),o=1,s=!0;var l={id:t.number,text:t.title,start_date:a,duration:o,progress:.1,unscheduled:s},d=[];d.push(l),d={data:d,links:[]},p.gantt.parse(d)})),null}))}));case 2:case"end":return t.stop()}}),t)}))),n.initZoom(),n}return Object(d.a)(e,t),Object(c.a)(e,[{key:"initZoom",value:function(){p.gantt.ext.zoom.init({levels:[{name:"Days",scale_height:60,min_column_width:70,scales:[{unit:"week",step:1,format:"Week #%W"},{unit:"day",step:1,format:"%d %M"}]},{name:"Months",scale_height:60,min_column_width:70,scales:[{unit:"month",step:1,format:"%F"},{unit:"week",step:1,format:"#%W"}]}]})}},{key:"setZoom",value:function(t){p.gantt.ext.zoom.setLevel(t)}},{key:"initGanttDataProcessor",value:function(){var t=this.props.onDataUpdated;this.dataProcessor=p.gantt.createDataProcessor((function(e,n,a,o){return new Promise((function(r,i){return t&&t(e,n,a,o),r()}))}))}},{key:"getStartDateFromBodyString",value:function(t){var e=t.match(/start_date: \d{4}\/\d{1,2}\/\d{1,2}/);return null==e?null:(e=e[0].match(/\d{4}\/\d{1,2}\/\d{1,2}/)[0],new Date(e))}},{key:"getDueDateFromBodyString",value:function(t){var e=t.match(/due_date: \d{4}\/\d{1,2}\/\d{1,2}/);return null==e?null:(e=e[0].match(/\d{4}\/\d{1,2}\/\d{1,2}/)[0],new Date(e))}},{key:"replaceStartDateInBodyString",value:function(t,e){return null!=this.getStartDateFromBodyString(t)?t.replace(/start_date: \d{4}\/\d{1,2}\/\d{1,2}/,"start_date: "+e):"start_date: "+e+"\n"+t}},{key:"replaceDueDateInBodyString",value:function(t,e){return null!=this.getDueDateFromBodyString(t)?t.replace(/due_date: \d{4}\/\d{1,2}\/\d{1,2}/,"due_date: "+e):"due_date: "+e+"\n"+t}},{key:"updateIssue",value:function(t,e){var n=this,a="https://api.github.com/repos/lamact/react-issue-ganttchart/issues/"+e.id,o=new Date(e.start_date),r=o.toLocaleDateString("ja-JP"),i=b()(o).add(e.duration,"d").toDate().toLocaleDateString("ja-JP");return k.a.get(a).then((function(t){var e=t.data.body;e=n.replaceDueDateInBodyString(e,i),e=n.replaceStartDateInBodyString(e,r),k.a.post(a,{body:e},{headers:{Authorization:"token ".concat(n.props.token)}}).then((function(t){console.log("success post")})).catch((function(t){alert.show("aa"),n.getGitHubIssues()}))})),null}},{key:"linkIssue",value:function(t,e){console.log(t),window.open("https://google.com","_blank")}},{key:"shouldComponentUpdate",value:function(t){return this.props.zoom!==t.zoom}},{key:"componentDidMount",value:function(){var t=this;p.gantt.config.xml_date="%Y/%m/%d %H:%i",p.gantt.config.order_branch=!0,p.gantt.config.order_branch_free=!0,p.gantt.config.show_unscheduled=!0,p.gantt.locale.labels.section_description="Issue Description",p.gantt.config.sort=!0,p.gantt.attachEvent("onTaskClick",(function(e,n){t.linkIssue(e,n)})),p.gantt.attachEvent("onAfterTaskUpdate",(function(e,n){t.updateIssue(e,n)})),p.gantt.init(this.ganttContainer),this.initGanttDataProcessor(),this.getGitHubIssues()}},{key:"componentWillUnmount",value:function(){this.dataProcessor&&(this.dataProcessor.destructor(),this.dataProcessor=null)}},{key:"render",value:function(){var t=this,e=this.props.zoom;return this.setZoom(e),o.a.createElement("div",{ref:function(e){t.ganttContainer=e},style:{width:"100%",height:"100%"}})}}]),e}(a.Component),_=(n(50),y),D=function(t){function e(){var t,n;Object(s.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(t=Object(l.a)(e)).call.apply(t,[this].concat(o)))).handleZoomChange=function(t){n.props.onZoomChange&&n.props.onZoomChange(t.target.value)},n.handleTokenChange=function(t){n.props.onTokenChange&&n.props.onTokenChange(t.target.value)},n.handleGitURLChange=function(t){n.props.onGitURLChange&&n.props.onGitURLChange(t.target.value)},n}return Object(d.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=this,e=["Days","Months"].map((function(e){var n=t.props.zoom===e;return o.a.createElement("label",{key:e,className:"radio-label ".concat(n?"radio-label-active":"")},o.a.createElement("input",{type:"radio",checked:n,onChange:t.handleZoomChange,value:e}),e)}));return o.a.createElement("div",{className:"tool-bar"},o.a.createElement("b",null,"URL: "),o.a.createElement("input",{type:"text",value:this.props.url,onChange:this.handleGitURLChange,className:"text-input-label"}),o.a.createElement("b",null,"Token: "),o.a.createElement("input",{type:"password",value:this.props.token,onChange:this.handleTokenChange,className:"text-input-label"}),o.a.createElement("b",null,"Zoom: "),e)}}]),e}(a.Component),C=(n(51),D),w=n(10),j=(n(52),function(t){function e(){var t,n;Object(s.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(t=Object(l.a)(e)).call.apply(t,[this].concat(o)))).state={currentZoom:"Months",messages:[],git_url:"",token:""},n.handleZoomChange=function(t){n.setState({currentZoom:t})},n.handleTokenChange=function(t){n.setState({token:t}),Object(w.bake_cookie)("personal_access_token",t)},n.handleGitURLChange=function(t){n.setState({git_url:t}),Object(w.bake_cookie)("git_url",t)},n}return Object(d.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){this.setState({token:Object(w.read_cookie)("personal_access_token")})}},{key:"render",value:function(){var t=this.state,e=t.currentZoom,n=t.git_url,a=t.token;return o.a.createElement("div",null,o.a.createElement("div",{className:"zoom-bar"},o.a.createElement(C,{zoom:e,onZoomChange:this.handleZoomChange,git_url:n,onGitURLChange:this.handleGitURLChange,token:a,onTokenChange:this.handleTokenChange})),o.a.createElement("div",{className:"gantt-container"},o.a.createElement(_,{zoom:e,git_url:n,token:a,onDataUpdated:this.logDataUpdate})))}}]),e}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[23,1,2]]]);
//# sourceMappingURL=main.a2c943c8.chunk.js.map