(this["webpackJsonpreact-issue-ganttchart"]=this["webpackJsonpreact-issue-ganttchart"]||[]).push([[0],{110:function(t,e,n){},111:function(t,e,n){},112:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),o=n(9),i=n.n(o),c=(n(76),n(12)),u=n.n(c),s=n(16),l=n(28),d=n(29),h=n(33),p=n(30),f=n(43),g=n(34),m=n(13),v=(n(78),function(t){return t.length>1&&/\/$/.test(t)&&(t=t.slice(0,-1)),t}),k=function(t){return t.length>1&&/ +$/.test(t)&&(t=t.slice(0,-1)),t},b=function(t){var e=t;return e=v(e),e=k(e),e=v(e),e=k(e)},_=function(t){if(null==t)return null;var e=t.match(/start_date: \d{4}\/\d{1,2}\/\d{1,2}/);return null==e?null:(e=e[0].match(/\d{4}\/\d{1,2}\/\d{1,2}/)[0],new Date(e))},w=function(t,e){return null!=_(t)?t.replace(/start_date: \d{4}\/\d{1,2}\/\d{1,2}/,"start_date: "+e):"start_date: "+e+"  \n"+t},C=function(t){if(null==t)return null;var e=t.match(/due_date: \d{4}\/\d{1,2}\/\d{1,2}/);return null==e?null:(e=e[0].match(/\d{4}\/\d{1,2}\/\d{1,2}/)[0],new Date(e))},y=function(t){if(null==t)return null;var e=t.match(/progress: \d{1}\.\d{1}/);return null==e?.1:(e=e[0].match(/\d{1}\.\d{1}/)[0],parseFloat(e))},j=function(t,e){var n=y(t),a=Math.round(10*e)/10;return"1"===e&&(e="1.0"),null!=n?t.replace(/progress: \d{1}\.\d{1}/,"progress: "+a):"progress: "+a+"  \n"+t},D="https://api.github.com/repos/",O=function(t){return/github\.com/.test(t)},L=function(t){var e=t.split("/");if(e.length>=5)return e[3]},S=function(t){var e=t.split("/");if(e.length>=5)return e[4]},G=function(t,e){var n=b(t);return D+L(n)+"/"+S(n)+"/issues/"+e},E=function(t,e){var n="";null===e&&e===[]||(n+="?labels=",e.map((function(t){return n+=t.name+",",null})));var a=b(t);return D+L(a)+"/"+S(a)+"/issues"+n},P=function(t){var e=b(t);return D+L(e)+"/"+S(e)+"/labels"},U=function(t){return/gitlab\.com/.test(t)},Z=function(t){var e=t.split("/");return e.length>=3?e[2]:null},x=function(t){var e=Z(t);return null!==e?"https://"+e+"/":"https://gitlab.com/"},R=function(t){return x(t)},A=function(t){return x(t)+"api/v4/projects/"},z=function(t){var e=t.split("/");if(e.length>=5)return e[3]},T=function(t){var e=t.split("/");if(e.length>=5)return e[4]},J=function(t){var e="";return e+=null!==t&&""!==t?"?access_token="+t+"&":"?"},W=function(t,e,n){var a=J(e);null===n&&n===[]||(a+="labels=",n.map((function(t){return a+=t.name+",",null})));var r=b(t);return A(t)+z(r)+"%2F"+T(r)+"/issues"+a},M=function(t,e){var n=J(e),a=b(t);return A(t)+z(a)+"%2F"+T(a)+"/labels"+n},N=n(17),F=n.n(N),V=n(47),I=n.n(V),B=function(t,e){var n=new Date(t);return I()(n).add(e-1,"d").toDate().toLocaleDateString("ja-JP")},$=function(t,e,n){return null!=t&&null!=e?t.toLocaleDateString("ja-JP"):new Date(n).toLocaleDateString("ja-JP")},H=function(t,e){return null!=t&&null!=e?function(t,e){var n=I()(t);return I()(e).diff(n,"days")+1}(t,e):1},Y=function(t,e){return null==t||null==e},q=function(t,e){var n=[];n.push(t),n={data:n,links:[]},e.parse(n),e.sort("start_date",!1)},K=function(t,e){var n=_(t),a=C(t);return{id:e.number,text:e.title,start_date:$(n,a,e.created_at),duration:H(n,a),progress:y(t),unscheduled:Y(n,a)}},Q=function(t,e){var n=new Date(e.start_date).toLocaleDateString("ja-JP"),a=B(n,e.duration);return t=function(t,e){return null!=C(t)?t.replace(/due_date: \d{4}\/\d{1,2}\/\d{1,2}/,"due_date: "+e):"due_date: "+e+"  \n"+t}(t=j(t,e.progress),a),t=w(t,n)},X=function(){var t=Object(s.a)(u.a.mark((function t(e,n,a){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:F.a.get(E(n,a)).then((function(t){t.data.map((function(t){return F.a.get(G(n,t.number)).then((function(n){var a=K(n.data.body,t);q(a,e)})),null}))}));case 1:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}(),tt=function(){var t=Object(s.a)(u.a.mark((function t(e,n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:F.a.get(P(n)).then((function(t){var n=[];t.data.map((function(t){return n.push(t),null})),e.setState({labels:n})}));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),et=function(t,e){window.open(function(t,e){var n=b(t);return"https://github.com/"+L(n)+"/"+S(n)+"/issues/"+e}(e,t),"_blank")},nt=function(t,e){var n="";n+="start_date:%20"+(new Date).toLocaleDateString("ja-JP")+"%0D%0A",n+="due_date:%20"+(new Date).toLocaleDateString("ja-JP")+"%0D%0A",n+="progress:%200.1%0D%0A",window.open(function(t){var e=b(t);return"https://github.com/"+L(e)+"/"+S(e)+"/issues/new?assignees=&labels=&title=&body="}(e)+n,"_blank")},at=function(t){var e=_(t.description),n=new Date(t.due_date).toLocaleDateString("ja-JP");return{id:t.iid,text:t.title,start_date:$(e,n,t.created_at),duration:H(e,n),progress:y(t.description),unscheduled:Y(e,n)}},rt=function(){var t=Object(s.a)(u.a.mark((function t(e,n,a,r){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:F.a.get(W(n,a,r)).then((function(t){t.data.map((function(t){var n=at(t);return q(n,e),null}))}));case 1:case"end":return t.stop()}}),t)})));return function(e,n,a,r){return t.apply(this,arguments)}}(),ot=function(){var t=Object(s.a)(u.a.mark((function t(e,n,a){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:F.a.get(M(n,a)).then((function(t){var n=[];t.data.map((function(t){return n.push(t),null})),e.setState({labels:n})}));case 1:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}(),it=function(t,e,n,a){F.a.get(function(t,e,n){var a=J(e),r=b(t);return A(t)+z(r)+"%2F"+T(r)+"/issues"+a}(a,e)).then((function(r){r.data.map((function(r){if(r.iid===t.id){var o=function(t,e){var n=new Date(e.start_date).toLocaleDateString("ja-JP");return t=j(t,e.progress),t=w(t,n),encodeURIComponent(t)}(r.description,t),i=new Date(t.start_date).toLocaleDateString("ja-JP"),c=B(i,t.duration),u=function(t,e,n){var a=J(e),r=b(t);return A(t)+z(r)+"%2F"+T(r)+"/issues/"+n+a}(a,e,t.id)+"&description="+o+"&due_date="+c;F.a.put(u).then((function(t){console.log("success update issue")})).catch((function(t){alert("failed update GitLab issue. check your token."),rt(n,a)}))}return null}))}))},ct=function(t,e){window.open(function(t,e){var n=b(t);return R(t)+z(n)+"/"+T(n)+"/-/issues/"+e}(e,t),"_blank")},ut=function(t,e){var n="";n+="start_date:%20"+(new Date).toLocaleDateString("ja-JP")+"%20%20%0D%0A",n+="progress:%200.1%0D%0A",window.open(function(t){var e=b(t);return R(t)+z(e)+"/"+T(e)+"/issues/new?issue[description]="}(e)+n,"_blank")},st=function(){var t=Object(s.a)(u.a.mark((function t(e,n,a,r){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.clearAll(),O(n)&&X(e,n,r),(U(n)||null!==Z(n))&&rt(e,n,a,r);case 3:case"end":return t.stop()}}),t)})));return function(e,n,a,r){return t.apply(this,arguments)}}(),lt=function(){var t=Object(s.a)(u.a.mark((function t(e,n,a){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:O(n)&&tt(e,n),(U(n)||null!==Z(n))&&ot(e,n,a);case 2:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}(),dt=function(t,e,n,a){O(a)&&function(t,e,n,a){var r=G(a,t.id);F.a.get(r).then((function(o){F.a.post(r,{body:Q(o.data.body,t)},{headers:{Authorization:"token ".concat(e)}}).then((function(t){console.log("success update issue")})).catch((function(t){alert("failed update GitHub issue. check your token."),X(n,a)}))}))}(t,e,n,a),(U(a)||null!==Z(a))&&it(t,e,n,a)},ht=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(h.a)(this,Object(p.a)(e).call(this,t))).dataProcessor=null,n.initZoom(),n}return Object(g.a)(e,t),Object(d.a)(e,[{key:"initZoom",value:function(){m.gantt.ext.zoom.init({levels:[{name:"Days",scale_height:60,min_column_width:70,scales:[{unit:"week",step:1,format:"%M, %d week"},{unit:"day",step:1,format:"%d %M"}]},{name:"Weeks",scale_height:60,min_column_width:70,scales:[{unit:"month",step:1,format:"%Y %F"},{unit:"week",step:1,format:"%M, %d week"}]}]})}},{key:"setZoom",value:function(t){m.gantt.ext.zoom.setLevel(t)}},{key:"initGanttDataProcessor",value:function(){var t=this.props.onDataUpdated;this.dataProcessor=m.gantt.createDataProcessor((function(e,n,a,r){return new Promise((function(o,i){return t&&t(e,n,a,r),o()}))}))}},{key:"updateGantt",value:function(t){st(m.gantt,this.props.git_url,this.props.token,t)}},{key:"shouldComponentUpdate",value:function(t){return this.props.zoom!==t.zoom}},{key:"componentDidMount",value:function(){var t=this;m.gantt.config.xml_date="%Y/%m/%d %H:%i",m.gantt.config.order_branch=!0,m.gantt.config.order_branch_free=!0,m.gantt.config.keep_grid_width=!0,m.gantt.config.grid_resize=!0,m.gantt.config.show_unscheduled=!0,m.gantt.config.sort=!0,m.gantt.attachEvent("onTaskDblClick",(function(e,n){!function(t,e){O(e)&&et(t,e),(U(e)||null!==Z(e))&&ct(t,e)}(e,t.props.git_url)})),m.gantt.attachEvent("onTaskCreated",(function(e,n){var a;a=t.props.git_url,O(a)&&nt(0,a),(U(a)||null!==Z(a))&&ut(0,a)})),m.gantt.attachEvent("onAfterTaskUpdate",(function(e,n){dt(n,t.props.token,m.gantt,t.props.git_url)})),m.gantt.init(this.ganttContainer),this.initGanttDataProcessor(),this.updateGantt()}},{key:"componentWillUnmount",value:function(){this.dataProcessor&&(this.dataProcessor.destructor(),this.dataProcessor=null)}},{key:"render",value:function(){var t=this,e=this.props.zoom;return this.setZoom(e),r.a.createElement("div",{ref:function(e){t.ganttContainer=e},style:{width:"100%",height:"100%"}})}}]),e}(a.Component),pt=(n(98),ht),ft=n(4),gt=n(148),mt=n(62),vt=n.n(mt),kt=n(149),bt=n(60),_t=n(114),wt=n(147),Ct=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(t=Object(p.a)(e)).call.apply(t,[this].concat(r)))).handleGitURLChange=function(t){n.props.onGitURLChange&&n.props.onGitURLChange(t.target.value)},n.handleTokenChange=function(t){n.props.onTokenChange&&n.props.onTokenChange(t.target.value)},n.handleUpdateClick=function(t){n.props.onUpdateClick&&n.props.onUpdateClick()},n.handleClickWeeks=function(t){n.handleZoomChange("Weeks")},n.handleClickDays=function(t){n.handleZoomChange("Days")},n.handleZoomChange=function(t){n.props.onZoomChange&&n.props.onZoomChange(t)},n.handleChange=function(t){n.setState({personName:t.target.value})},n.onSelect=function(t){n.props.onLabelChange&&n.props.onLabelChange(t)},n.onRemove=function(t){n.props.onLabelChange&&n.props.onLabelChange(t)},n}return Object(g.a)(e,t),Object(d.a)(e,[{key:"render",value:function(){var t=this.props.classes;return r.a.createElement("form",{noValidate:!0},r.a.createElement(kt.a,{className:t.root,required:!0,placeholder:"https://github.com/lamact/react-issue-ganttchart",defaultValue:"https://github.com/lamact/react-issue-ganttchart",label:"Git Repository URL",style:{width:"25%",verticalAlign:"middle"},onChange:this.handleGitURLChange}),r.a.createElement(kt.a,{className:t.root,type:"password",placeholder:"Access Token",defaultValue:"Access Token",label:"Access Token",style:{width:"10%",verticalAlign:"middle"},onChange:this.handleTokenChange}),r.a.createElement(bt.Multiselect,{className:t.root,options:this.props.labels,selectedValues:this.props.selectedValue,onSelect:this.onSelect,onRemove:this.onRemove,displayValue:"name",style:yt,placeholder:"filter by labels",hidePlaceholder:"false",emptyRecordMsg:"No Labels",closeIcon:"cancel"}),r.a.createElement(wt.a,{size:"small",style:{height:"34px"}},r.a.createElement(_t.a,{onClick:this.handleClickWeeks},"Weeks"),r.a.createElement(_t.a,{onClick:this.handleClickDays},"Days")),r.a.createElement(gt.a,{color:"primary",style:{verticalAlign:"middle"}},r.a.createElement(vt.a,{onClick:this.handleUpdateClick})))}}]),e}(a.Component),yt={multiselectContainer:{width:"50%",display:"inline-block",verticalAlign:"middle",padding:"4px",alignItems:"flex-end"},chips:{background:"light blue",fontSize:"15px"},searchBox:{border:"none"}},jt=Object(ft.a)((function(t){return{root:{"& > *":{margin:t.spacing(1),fontSize:"15px"}}}}))(Ct),Dt=(n(110),jt),Ot=n(19),Lt=(n(111),function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(h.a)(this,Object(p.a)(e).call(this,t))).handleZoomChange=function(t){n.setState({currentZoom:t}),Object(Ot.bake_cookie)("currentZoom",t)},n.handleTokenChange=function(t){n.setState({token:t})},n.handleGitURLChange=function(t){n.setState({git_url:t})},n.updateGantt=function(){var t=Object(s.a)(u.a.mark((function t(e){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.GanttRef.current.updateGantt(e),lt(Object(f.a)(n),n.state.git_url,n.state.token);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),n.handleUpdateClick=function(){Object(Ot.bake_cookie)("access_token",n.state.token),Object(Ot.bake_cookie)("url",n.state.git_url),n.updateGantt(n.state.selected_labels)},n.handleLabelChange=function(t){n.updateGantt(t),n.setState({selected_labels:t})},n.state={currentZoom:"Weeks",messages:[],git_url:"",token:"",labels:[],selected_labels:[]},n.GanttRef=r.a.createRef(),n}return Object(g.a)(e,t),Object(d.a)(e,[{key:"componentDidMount",value:function(){this.setState({token:Object(Ot.read_cookie)("access_token")}),this.setState({git_url:Object(Ot.read_cookie)("url")}),"Weeks"!==Object(Ot.read_cookie)("currentZoom")&&"Days"!==Object(Ot.read_cookie)("currentZoom")||this.setState({currentZoom:Object(Ot.read_cookie)("currentZoom")})}},{key:"render",value:function(){var t=this.state,e=t.currentZoom,n=t.git_url,a=t.token,o=t.labels;return r.a.createElement("div",null,r.a.createElement("div",{className:"zoom-bar"},r.a.createElement(Dt,{zoom:e,onZoomChange:this.handleZoomChange,git_url:n,onGitURLChange:this.handleGitURLChange,token:a,onTokenChange:this.handleTokenChange,onUpdateClick:this.handleUpdateClick,labels:o,onLabelChange:this.handleLabelChange})),r.a.createElement("div",{className:"gantt-container"},r.a.createElement(pt,{ref:this.GanttRef,zoom:e,git_url:n,token:a})))}}]),e}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(Lt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},71:function(t,e,n){t.exports=n(112)},76:function(t,e,n){},98:function(t,e,n){}},[[71,1,2]]]);
//# sourceMappingURL=main.fbcc054f.chunk.js.map