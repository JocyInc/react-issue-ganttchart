(this["webpackJsonpreact-issue-ganttchart"]=this["webpackJsonpreact-issue-ganttchart"]||[]).push([[0],{23:function(t,e,n){t.exports=n(53)},28:function(t,e,n){},50:function(t,e,n){},51:function(t,e,n){},52:function(t,e,n){},53:function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),r=n(22),i=n.n(r),c=(n(28),n(6)),u=n(7),s=n(10),l=n(8),d=n(11),h=n(1),p=(n(29),n(3)),f=n.n(p),g=n(9),m=n(12),k=n.n(m),v=function(t){return t.length>1&&/\/$/.test(t)&&(t=t.slice(0,-1)),t},b=function(t){return t.length>1&&/ +$/.test(t)&&(t=t.slice(0,-1)),t},_=function(t){var e=t;return e=v(e),e=b(e),e=v(e),e=b(e)},w=function(t){if(null==t)return null;var e=t.match(/start_date: \d{4}\/\d{1,2}\/\d{1,2}/);return null==e?null:(e=e[0].match(/\d{4}\/\d{1,2}\/\d{1,2}/)[0],new Date(e))},C=function(t){if(null==t)return null;var e=t.match(/due_date: \d{4}\/\d{1,2}\/\d{1,2}/);return null==e?null:(e=e[0].match(/\d{4}\/\d{1,2}\/\d{1,2}/)[0],new Date(e))},y=function(t){if(null==t)return null;var e=t.match(/progress: \d{1}\.\d{1}/);return null==e?.1:(e=e[0].match(/\d{1}\.\d{1}/)[0],parseFloat(e))},j=function(t,e,n,a){return t=function(t,e){return null!=w(t)?t.replace(/start_date: \d{4}\/\d{1,2}\/\d{1,2}/,"start_date: "+e):"start_date: "+e+"\n"+t}(t=function(t,e){return null!=C(t)?t.replace(/due_date: \d{4}\/\d{1,2}\/\d{1,2}/,"due_date: "+e):"due_date: "+e+"\n"+t}(t=function(t,e){var n=y(t),a=Math.round(10*e)/10;return null!=n?t.replace(/progress: \d{1}\.\d{1}/,"progress: "+a):"progress: "+a+"\n"+t}(t,a),n),e)},D=function(t,e){var n=e.start_date,a=function(t,e){var n=new Date(t);return k()(n).add(e-1,"d").toDate().toLocaleDateString("ja-JP")}(n,e.duration);return j(t,n,a,e.progress)},O=function(t,e){var n=w(t),a=C(t);return null!=n&&null!=a?n.toLocaleDateString("ja-JP"):new Date(e).toLocaleDateString("ja-JP")},E=function(t){var e=w(t),n=C(t);return null!=e&&null!=n?function(t,e){var n=k()(t);return k()(e).diff(n,"days")+1}(e,n):1},U=function(t){return y(t)},Z=function(t){var e=w(t),n=C(t);return null==e||null==n},G=function(t,e){var n=[];n.push(t),n={data:n,links:[]},e.parse(n),e.sort("start_date",!1)},L=function(t){return/github\.com/.test(t)},P=function(t){var e=t.split("/");if(e.length>=5)return e[3]},S=function(t){var e=t.split("/");if(e.length>=5)return e[4]},z=function(t){var e=_(t);return"https://api.github.com/repos/"+P(e)+"/"+S(e)},R=function(t){var e=_(t);return"https://github.com/"+P(e)+"/"+S(e)},x=function(t,e){return{id:e.number,text:e.title,start_date:O(t,e.created_at),duration:E(t),progress:U(t),unscheduled:Z(t)}},T=function(t){return/gitlab\.com/.test(t)},A=function(t){var e=t.split("/");if(e.length>=5)return e[3]},M=function(t){var e=t.split("/");if(e.length>=5)return e[4]},J=function(t){var e=_(t);return"https://gitlab.com/api/v4/projects/"+A(e)+"%2F"+M(e)},N=function(t){var e=_(t);return"https://gitlab.com/"+A(e)+"/"+M(e)},F=function(t){return{id:t.iid,text:t.title,start_date:O(t.description,t.created_at),duration:E(t.description),progress:U(t.description),unscheduled:Z(t.description)}},W=n(4),$=n.n(W),B=function(){var t=Object(g.a)(f.a.mark((function t(e,n){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=z(n)+"/issues",$.a.get(a).then((function(t){t.data.map((function(t){return $.a.get(a+"/"+t.number).then((function(n){var a=x(n.data.body,t);G(a,e)})),null}))}));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),H=function(){var t=Object(g.a)(f.a.mark((function t(e,n,a){var o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=J(n)+"/issues?access_token="+a,$.a.get(o).then((function(t){t.data.map((function(t){console.log(t);var n=F(t);return G(n,e),null}))}));case 2:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}(),Y=function(){var t=Object(g.a)(f.a.mark((function t(e,n,a){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.clearAll(),L(n)&&B(e,n),T(n)&&H(e,n,a);case 3:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}(),I=function(t,e,n,a){L(a)&&function(t,e,n,a){var o=z(a)+"/issues/"+t.id;$.a.get(o).then((function(r){var i=D(r.data.body,t);$.a.post(o,{body:i},{headers:{Authorization:"token ".concat(e)}}).then((function(t){console.log("success update issue")})).catch((function(t){alert("failed update GitHub issue. check your token."),B(n,a)}))}))}(t,e,n,a),T(a)&&function(t,e,n,a){var o=J(a)+"/issues/"+t.id;$.a.get(o).then((function(r){var i=D(r.data.body,t);$.a.post(o,{body:i},{headers:{Authorization:"token ".concat(e)}}).then((function(t){console.log("success update issue")})).catch((function(t){alert("failed update GitLab issue. check your token."),H(n,a)}))}))}(t,e,n,a)},q=function(t,e){L(e)&&function(t,e){window.open(R(e)+"/issues/"+t,"_blank")}(t,e),T(e)&&function(t,e){window.open(N(e)+"/-/issues/"+t,"_blank")}(t,e)},K=function(t,e){L(e)&&function(t,e){var n="";n+="start_date:%20"+(new Date).toLocaleDateString("ja-JP")+"%0D%0A",n+="due_date:%20"+(new Date).toLocaleDateString("ja-JP")+"%0D%0A",n+="progress:%200.1%0D%0A",window.open(R(e)+"/issues/new?assignees=&labels=&title=&body="+n,"_blank")}(0,e),T(e)&&function(t,e){var n="";n+="start_date:%20"+(new Date).toLocaleDateString("ja-JP")+"%0D%0A",n+="progress:%200.1%0D%0A",window.open(N(e)+"/issues/new?issue[description]="+n,"_blank")}(0,e)},Q=function(t){function e(t){var n;return Object(c.a)(this,e),(n=Object(s.a)(this,Object(l.a)(e).call(this,t))).dataProcessor=null,n.initZoom(),n}return Object(d.a)(e,t),Object(u.a)(e,[{key:"initZoom",value:function(){h.gantt.ext.zoom.init({levels:[{name:"Days",scale_height:60,min_column_width:70,scales:[{unit:"week",step:1,format:"%M, %d week"},{unit:"day",step:1,format:"%d %M"}]},{name:"Months",scale_height:60,min_column_width:70,scales:[{unit:"month",step:1,format:"%Y %F"},{unit:"week",step:1,format:"%M, %d week"}]}]})}},{key:"setZoom",value:function(t){h.gantt.ext.zoom.setLevel(t)}},{key:"initGanttDataProcessor",value:function(){var t=this.props.onDataUpdated;this.dataProcessor=h.gantt.createDataProcessor((function(e,n,a,o){return new Promise((function(r,i){return t&&t(e,n,a,o),r()}))}))}},{key:"updateGantt",value:function(){Y(h.gantt,this.props.git_url,this.props.token)}},{key:"shouldComponentUpdate",value:function(t){return this.props.zoom!==t.zoom}},{key:"componentDidMount",value:function(){var t=this;h.gantt.config.xml_date="%Y/%m/%d %H:%i",h.gantt.config.order_branch=!0,h.gantt.config.order_branch_free=!0,h.gantt.config.keep_grid_width=!0,h.gantt.config.grid_resize=!0,h.gantt.config.show_unscheduled=!0,h.gantt.config.sort=!0,h.gantt.attachEvent("onTaskDblClick",(function(e,n){q(e,t.props.git_url)})),h.gantt.attachEvent("onTaskCreated",(function(e,n){K(0,t.props.git_url)})),h.gantt.attachEvent("onAfterTaskUpdate",(function(e,n){I(e,t.props.token,h.gantt,t.props.git_url)})),h.gantt.attachEvent("onScaleClick",(function(t,e){console.log(t)})),h.gantt.attachEvent("onEmptyClick",(function(t){})),h.gantt.init(this.ganttContainer),this.initGanttDataProcessor(),this.updateGantt()}},{key:"componentWillUnmount",value:function(){this.dataProcessor&&(this.dataProcessor.destructor(),this.dataProcessor=null)}},{key:"render",value:function(){var t=this,e=this.props.zoom;return this.setZoom(e),o.a.createElement("div",{ref:function(e){t.ganttContainer=e},style:{width:"100%",height:"100%"}})}}]),e}(a.Component),V=(n(50),Q),X=function(t){function e(){var t,n;Object(c.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(s.a)(this,(t=Object(l.a)(e)).call.apply(t,[this].concat(o)))).handleZoomChange=function(t){n.props.onZoomChange&&n.props.onZoomChange(t.target.value)},n.handleTokenChange=function(t){n.props.onTokenChange&&n.props.onTokenChange(t.target.value)},n.handleGitURLChange=function(t){n.props.onGitURLChange&&n.props.onGitURLChange(t.target.value)},n.handleUpdateClick=function(t){n.props.onUpdateClick&&n.props.onUpdateClick()},n}return Object(d.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this,e=["Days","Months"].map((function(e){var n=t.props.zoom===e;return o.a.createElement("label",{key:e,className:"radio-label ".concat(n?"radio-label-active":"")},o.a.createElement("input",{type:"radio",checked:n,onChange:t.handleZoomChange,value:e}),e)}));return o.a.createElement("div",{className:"tool-bar"},o.a.createElement("b",null,"URL: "),o.a.createElement("input",{type:"text",value:this.props.url,onChange:this.handleGitURLChange,className:"text-input-label"}),o.a.createElement("b",null,"Token: "),o.a.createElement("input",{type:"password",value:this.props.token,onChange:this.handleTokenChange,className:"token-input-label"}),o.a.createElement("button",{onClick:this.handleUpdateClick,className:"button"},"Update"),o.a.createElement("b",null,"Zoom: "),e)}}]),e}(a.Component),tt=(n(51),X),et=n(5),nt=(n(52),function(t){function e(t){var n;return Object(c.a)(this,e),(n=Object(s.a)(this,Object(l.a)(e).call(this,t))).handleZoomChange=function(t){n.setState({currentZoom:t}),Object(et.bake_cookie)("currentZoom",t)},n.handleTokenChange=function(t){n.setState({token:t})},n.handleGitURLChange=function(t){n.setState({git_url:t})},n.handleUpdateClick=function(){n.GanttRef.current.updateGantt(),Object(et.bake_cookie)("token",n.state.token),Object(et.bake_cookie)("git_url",n.state.git_url)},n.state={currentZoom:"Months",messages:[],git_url:"",token:""},n.GanttRef=o.a.createRef(),n}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){this.setState({token:Object(et.read_cookie)("token")}),this.setState({git_url:Object(et.read_cookie)("git_url")}),"Days"!==Object(et.read_cookie)("currentZoom")&&"Months"!==Object(et.read_cookie)("currentZoom")||this.setState({currentZoom:Object(et.read_cookie)("currentZoom")})}},{key:"render",value:function(){var t=this.state,e=t.currentZoom,n=t.git_url,a=t.token;return o.a.createElement("div",null,o.a.createElement("div",{className:"zoom-bar"},o.a.createElement(tt,{zoom:e,onZoomChange:this.handleZoomChange,git_url:n,onGitURLChange:this.handleGitURLChange,token:a,onTokenChange:this.handleTokenChange,onUpdateClick:this.handleUpdateClick})),o.a.createElement("div",{className:"gantt-container"},o.a.createElement(V,{ref:this.GanttRef,zoom:e,git_url:n,token:a})))}}]),e}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(nt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[23,1,2]]]);
//# sourceMappingURL=main.eee4df94.chunk.js.map